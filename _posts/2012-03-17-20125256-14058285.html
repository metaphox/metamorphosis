---
title: Lambda 表达式有何用处？如何使用？
layout: post
---
简单来说，编程中提到的 lambda 表达式，通常是在<b>需要一个函数，但是又不想费神去命名一个函数</b>的场合下使用，也就是指<b>匿名函数</b>。这一用法跟所谓 λ 演算（题目说明里的维基链接）的关系，有点像原子弹和质能方程的关系，差别其实还是挺大的。<br><br>不谈形式化的 λ 演算，只说有实际用途的匿名函数。先举一个普通的 Python 例子：将一个 list 里的每个元素都平方：<br><div class="highlight"><pre><code class="language-python"><span class="nb">map</span><span class="p">(</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span> <span class="p">)</span>
</code></pre></div>这个写法要好过<br><div class="highlight"><pre><code class="language-python"><span class="k">def</span> <span class="nf">sq</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>

<span class="nb">map</span><span class="p">(</span><span class="n">sq</span><span class="p">,</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span>
</code></pre></div>，因为后者多定义了一个（污染环境的）函数，尤其如果这个函数只会使用一次的话。而且第一种写法实际上更易读，因为那个映射到列表上的函数具体是要做什么，非常一目了然。如果你仔细观察自己的代码，会发现这种场景其实很常见：你在某处就真的只需要一个能做一件事情的函数而已，连它叫什么名字都无关紧要。Lambda 表达式就可以用来做这件事。<br><br>进一步讲，匿名函数本质上就是一个函数，它所抽象出来的东西是一组运算。这是什么意思呢？类比<br><div class="highlight"><pre><code class="language-text">a = [1, 2, 3]
</code></pre></div>和<br><div class="highlight"><pre><code class="language-text">f = lambda x : x + 1
</code></pre></div>，你会发现，等号右边的东西完全可以脱离等号左边的东西而存在，等号左边的<b>名字</b>只是右边之<b>实体</b>的标识符。如果你能习惯 [1, 2, 3] 单独存在，那么 lambda x : x + 1 也能单独存在其实也就不难理解了，它的意义就是给「某个数加一」这一运算本身。<br><br>现在回头来看 map() 函数，它可以将一个函数映射到一个可枚举类型上面。沿用上面给出的 a 和 f，可以写：<br><div class="highlight"><pre><code class="language-python"><span class="nb">map</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</code></pre></div>也就是将函数 f 依次套用在 a 的每一个元素上面，获得结果 [2, 3, 4]。现在用 lambda 表达式来替换 f，就变成：<br><div class="highlight"><pre><code class="language-python"><span class="nb">map</span><span class="p">(</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="p">)</span>
</code></pre></div>会不会觉得现在很一目了然了？尤其是类比<br><div class="highlight"><pre><code class="language-python"><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">r</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
    <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">each</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>这样的写法时，你会发现自己如果能将「遍历列表，给遇到的每个元素都做某种<b>运算</b>」的过程从一个循环里抽象出来成为一个函数 map，然后用 lambda 表达式将这种<b>运算</b>作为参数传给 map 的话，考虑事情的思维层级会高出一些来，需要顾及的细节也少了一点。Python 之中，类似能用到 lambda 表达式的「高级」函数还有 reduce、filter 等等，很多语言也都有这样的工具（不过这些特性最好不要在 Python 中用太多，原因详见 <a href="http://www.zhihu.com/question/19794855/answer/12987428" class="internal"><span class="invisible">http://www.</span><span class="visible">zhihu.com/question/1979</span><span class="invisible">4855/answer/12987428</span><span class="ellipsis"></span></a> 的评论部分）。这种能够接受一个函数作为参数的函数叫做「高阶函数」（higher-order function），是来自函数式编程（functional programming）的思想。<br><br>和其他很多语言相比，Python 的 lambda 限制多多，最严重的当属它只能由一条表达式组成。这个限制主要是为了防止滥用，因为当人们发觉 lambda 很方便，就比较容易滥用，可是用多了会让程序看起来不那么清晰，毕竟每个人对于抽象层级的忍耐 / 理解程度都有所不同。
<hr>
原发布于 <a href="https://www.zhihu.com/question/20125256/answer/14058285">https://www.zhihu.com/question/20125256/answer/14058285</a></p>